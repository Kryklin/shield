@use '../../styles/glass';

.sidenav-container {
    height: 100%;
    background: transparent !important; // Let body gradient show through
}

.mat-drawer-content {
    background: transparent !important;
    overflow: hidden; // Prevent horizontal scroll
    overflow-y: auto; // Allow vertical scrolling for long content (Dashboard, etc.)
}

.sidenav {
    width: 280px;
    background: var(--sys-surface-glass);
    backdrop-filter: blur(20px);
    border-right: 1px solid var(--sys-border);
    transition: background 0.3s, border-color 0.3s;

    // Dashboard specific styling to match headers
    .dashboard-item {
        margin: 0 !important;
        border-radius: 0 !important;
        height: 54px !important;
        padding: 0 24px !important; // Align with expansion panel headers
        color: var(--sys-text-primary) !important;
        
        // Ensure content alignment matches expansion headers (icon + text gap)
        // Ensure content alignment matches expansion headers (icon + text gap)
        .dashboard-content-wrapper {
            display: flex;
            align-items: center;
            gap: 16px; 
            width: 100%;
            height: 100%;
        }

        &:hover {
            background: var(--sys-border-light) !important;
            color: var(--sys-text-primary) !important;
        }

        mat-icon {
            color: var(--sys-text-tertiary);
            margin-right: 0 !important; // Reset Material default margin
        }
        
        // Force Black Text in Light Mode
        :host-context(body.light-theme) & {
            color: #000000 !important;
            font-weight: 500;
            
            .dashboard-content-wrapper {
                 color: #000000 !important;
            }
            
            mat-icon {
                 color: #000000 !important;
                 opacity: 0.7;
            }
        }
    }

    // Accordion styling tweaks
    .mat-expansion-panel {
        background: transparent !important;
        box-shadow: none !important;
        border-radius: 0 !important;

        &.mat-expanded {
            background: var(--sys-border-light) !important;
        }
    }

    .mat-expansion-panel-header {
        height: 54px !important;
        padding: 0 24px !important;
        
        &:hover {
            background: var(--sys-border-light) !important;
        }

        .mat-expansion-panel-header-title {
            color: var(--sys-text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 16px; // Align with nav list icons

            mat-icon {
                margin-right: 0; // Reset default margin
                color: var(--sys-text-tertiary);
            }
        }
        
        // Force Black Text in Light Mode
        :host-context(body.light-theme) & {
             .mat-expansion-panel-header-title {
                 color: #000000 !important;
                 font-weight: 500;
             }
             mat-icon {
                 color: #000000 !important;
                 opacity: 0.7;
             }
        }
    }

    // Nested items indentation
    .nav-group-items {
        padding-bottom: 8px;
        
        a.mat-mdc-list-item {
            padding-left: 24px !important; // Indent nested items
            
            .mdc-list-item__content {
                padding-left: 32px !important; // Further visual indentation
            }

            mat-icon {
                transform: scale(0.9); // Slightly smaller icons for nested items
            }

            // FORCE BLACK TEXT IN LIGHT MODE - CRITICAL FIX
            :host-context(body.light-theme) & {
                 // Target the wrapper
                 color: #000000 !important;
                 --mdc-list-list-item-label-text-color: #000000 !important;
                 --mdc-list-list-item-leading-icon-color: #000000 !important;
                 
                 // Target the inner content specifically
                 .mdc-list-item__content, 
                 .mdc-list-item__primary-text,
                 span,
                 div {
                     color: #000000 !important;
                     font-weight: 500 !important; 
                 }
                 
                 // Target the icon specifically
                 mat-icon {
                     color: #000000 !important;
                     opacity: 1 !important; // Remove any transparency
                     font-weight: bold !important;
                 }
            }
        }
    }
}

.active-link {
    background: var(--sys-primary-dim) !important;
    // Use box-shadow instad of border to prevent layout shift (3px displacement)
    box-shadow: inset 3px 0 0 var(--sys-primary) !important;
    border-left: none !important;
    
    // Ensure text brightness on active
    &.dashboard-item, & .mat-expansion-panel-header-title, & .mdc-list-item__content {
        color: var(--sys-text-primary) !important;
        font-weight: 500;
    }

    mat-icon {
        color: var(--sys-primary) !important;
        opacity: 1 !important;
    }
}
