<div class="topnav">
  <div class="drag-region">
    <app-logo size="32px"></app-logo>
    <span class="app-title">System Hardening Interface for Enhanced Logical Defense</span>
  </div>
  
  <div class="window-controls">
    <!-- Update Status Indicator -->
    @switch (github.updateStatus()) {
      @case ('checking') {
        <div class="update-status checking" title="Checking for updates...">
          <mat-spinner diameter="16"></mat-spinner>
        </div>
      }
      @case ('uptodate') {
        <div class="update-status uptodate" [title]="'Up to date (v' + github.latestRelease()?.tag_name + ')'">
          <mat-icon>check_circle</mat-icon>
          <span class="version-text">{{ github.latestRelease()?.tag_name }}</span>
        </div>
      }
      @case ('outdated') {
        <a [href]="github.latestRelease()?.html_url" target="_blank" class="update-status outdated" [title]="'Update available: ' + github.latestRelease()?.tag_name">
          <mat-icon class="pulse-icon">system_update</mat-icon>
          <span class="version-text">Update Available</span>
        </a>
      }
      @case ('error') {
        <!-- Silent fail or subtle indicator -->
        <div class="update-status error" title="Failed to check updates">
           <mat-icon>wifi_off</mat-icon>
        </div>
      }
    }

    <button mat-icon-button 
            (click)="toggleAdminMode()" 
            [title]="isAdmin ? 'Running as Administrator' : 'Relaunch as Administrator'"
            [class.admin-active]="isAdmin"
            [class.admin-inactive]="!isAdmin"
            [matMenuTriggerFor]="adminMenu"
            #adminMenuTrigger="matMenuTrigger">
      <mat-icon>{{ isAdmin ? 'verified_user' : 'gpp_maybe' }}</mat-icon>
    </button>
    
    <mat-menu #adminMenu="matMenu" xPosition="before" class="glass-menu">
        <div class="admin-popup-content" (click)="$event.stopPropagation()" (keydown.enter)="$event.stopPropagation()" tabindex="0">
            <p><strong>Admin Access Required</strong></p>
            <p>You can use this button to restart as Administrator.</p>
            <p class="sub-text">Some commands require UAC elevation if you don't restart.</p>
            <div class="actions">
                <button mat-stroked-button color="warn" (click)="toggleAdminMode(); adminMenuTrigger.closeMenu()">Restart Admin</button>
                <button mat-button (click)="adminMenuTrigger.closeMenu()">Dismiss</button>
            </div>
        </div>
    </mat-menu>
  </div>
</div>
